<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Search Console Tools</title>
	<link rel="preconnect" href="https://cdn.jsdelivr.net">
	<link rel="preconnect" href="https://pages.github.com">
	<link rel="icon" type="image/x-icon" href="https://pages.github.com/favicon.ico" />
	<meta name="description" content="Free Tools Google Search Console or webmasters, available free for all and open source script">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" media="all">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=arrow_drop_down" />
	<style> .btn,.form-control,.card{ border-radius: 0px; } .material-symbols-outlined {font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24 } #ads .card-header:hover{ cursor:pointer; }</style>
	<script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
</head>
<body>
	<header>
		<nav class="navbar navbar-light bg-info justify-content-center">
			<a class="navbar-brand font-weight-bold text-white" href="/">Search Console Tools</a>
		</nav>
	</header>
	<div class="container mt-4">
		<div class="container-fluid">
			<div class="card bg-light" id="add-domain">
				<div class="card-body">
					<div class="card-title font-weight-bold">Refresh Token : <a href="https://developers.google.com/oauthplayground/#step1&scopes=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fwebmasters%2Chttps%3A%2F%2Fwww.googleapis.com%2Fauth%2Fsiteverification&url=https%3A%2F%2F&content_type=application%2Fjson&http_method=GET&useDefaultOauthCred=checked&oauthEndpointSelect=Google&oauthAuthEndpointValue=https%3A%2F%2Faccounts.google.com%2Fo%2Foauth2%2Fv2%2Fauth&oauthTokenEndpointValue=https%3A%2F%2Foauth2.googleapis.com%2Ftoken&oauthClientId=12279730068-c6lqnplc2fku9h1vpbsnv5mouhcva3if.apps.googleusercontent.com&oauthClientSecret=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&includeCredentials=checked&accessTokenType=bearer&autoRefreshToken=unchecked&accessType=offline&prompt=consent&response_type=code&wrapLines=on" target="_blank">Get it!</a></div>
					<div class="input-group mb-3">
						<input type="text" id="refresh_token" class="form-control" placeholder="1//04gfKOj9G-LkvCgYIARAAGAQSNwF-L9IrsM9zA0S-4DdXldsonWI4pfUjQItgNxjoVlFvPlDz4LIDLKYk3gyoVp4uGi0JahQB1ys" aria-label="Refresh token" aria-describedby="generate">
						<div class="input-group-append">
							<button class="btn btn-outline-secondary" type="button" id="generate" onclick="generate_token()">Generate</button>
						</div>
					</div>
					<input class="w-100 form-control mt-2" placeholder="access_token" id="access_token">
				</div>
			</div>
		</div>
		<div class="row row-cols-1 row-cols-sm-1 row-cols-md-2 mt-4">
			<div class="col mt-4" id="ads">
				<div class="container">
					<div class="card" id="add-domain">
						<div onClick="toggle(this)" class="card-header d-flex justify-content-between align-items-center">
							Add Domain <button class="btn btn-sm"><span class="material-symbols-outlined">arrow_drop_down</span></button>
						</div>
						<div class="card-body" style="display: none">
							<textarea class="w-100 form-control" rows="8" placeholder="https://examples.net" id="domain-add"></textarea>
							<div class="row justify-content-between mt-2">
								<div class="col"><button class="btn btn-success" type="button" onclick="add_domain()">Submit</button></div>
								<div class="col text-right"><button class="btn btn-danger" type="button" onclick="clearit('domain-add')">Clear</button></div>
							</div>
						</div>
					</div>
					<div class="card mt-4">
						<div onClick="toggle(this)" class="card-header d-flex justify-content-between align-items-center">
							Verify All Unverified (HTML) <button class="btn btn-sm" ><span class="material-symbols-outlined">arrow_drop_down</span></button>
						</div>
						<div class="card-body text-center" style="display: none">
							<button class="btn btn-success w-50" type="button" onclick="verify_domain()">Submit</button>
						</div>
					</div>
					<div class="card mt-4">
						<div onClick="toggle(this)" class="card-header d-flex justify-content-between align-items-center">
							Add Owner <button class="btn btn-sm" ><span class="material-symbols-outlined">arrow_drop_down</span></button>
						</div>
						<div class="card-body text-center" style="display: none">
							<button class="btn btn-success w-50" type="button" onclick="verify_domain()">Submit</button>
						</div>
					</div>
					<div class="card mt-4">
						<div onClick="toggle(this)" class="card-header d-flex justify-content-between align-items-center">
							Delete All Sites <button class="btn btn-sm" ><span class="material-symbols-outlined">arrow_drop_down</span></button>
						</div>
						<div class="card-body text-center" style="display: none">
							<button class="btn btn-danger w-50" type="button" onclick="deletes()">Delete</button>
						</div>
					</div>
					<div class="card mt-4">
						<div onClick="toggle(this)" class="card-header d-flex justify-content-between align-items-center">
							Delete Unverified Sites <button class="btn btn-sm" ><span class="material-symbols-outlined">arrow_drop_down</span></button>
						</div>
						<div class="card-body text-center" style="display: none">
							<button class="btn btn-danger w-50" type="button" onclick="deleteu()">Delete</button>
						</div>
					</div>
					<div class="card mt-4">
						<div onClick="toggle(this)" class="card-header d-flex justify-content-between align-items-center">
							Delete Sites <button class="btn btn-sm" ><span class="material-symbols-outlined">arrow_drop_down</span></button>
						</div>
						<div class="card-body" style="display: none">
							<textarea class="w-100 form-control" rows="8" placeholder="https://examples.net" id="domain-delete"></textarea>
							<div class="row justify-content-between mt-2">
								<div class="col"><button class="btn btn-danger" onclick="domaindelete()">Delete</button></div>
							</div>
						</div>
					</div>
					<div class="card mt-4">
						<div onClick="toggle(this)" class="card-header d-flex justify-content-between align-items-center">
							Put Sitemap <button class="btn btn-sm" ><span class="material-symbols-outlined">arrow_drop_down</span></button>
						</div>
						<div class="card-body" style="display: none">
							<div class="row">
								<div class="col">
									<div class="card-title">Domain :</div>
								</div>
								<div class="col">
									<div class="text-right"><a class="closelink" href="#" onclick="generate_domain()">Generate</a></div>
								</div>
							</div>
							<textarea class="w-100 form-control" rows="8" placeholder="https://examples.net" id="domain-verified"></textarea>
							<div class="card-title mt-2">Sitemap Path :</div>
							<textarea class="w-100 form-control" rows="8" placeholder="https://sub.examples.net/sitemap.xml" id="put-sitemap"></textarea>
							<div class="row justify-content-between mt-2">
								<div class="col"><button class="btn btn-success" onclick="putsitemap()">Submit</button></div>
								<div class="col text-right"><button class="btn btn-danger" type="button" onclick="clearit('domain-verified');clearit('put-sitemap');">Clear</button></div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="col mt-4">
				<div class="container">
					<div class="card">
						<div class="card-header">
							<p class="text-muted">Console Log &nbsp; <a class="closelink" href="#" onclick="clear_log()">Clear</a></p>
							<textarea aria-labelledby="Console Log" id="log" class="w-100 form-control text-monospace" style="background: transparent;border: none; font-size: 14px" rows="25"></textarea>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<footer class="my-3 pt-3 text-center text-small">
		<div class="text-muted">Copyright &copy 2024 - <span id="year"></span> by Abi</div>
		<div class="font-weight-bold"><a href="https://github.com/source" target="_blank" class="text-success">Github</a></div>
	</footer>
</body>
<script type="text/javascript">
$(document).ready(function(){
    document.getElementById("year").innerHTML = new Date().getFullYear();
}); 

const closeLinks = document.querySelectorAll('.closelink');
closeLinks.forEach(link => {link.addEventListener('click', (event) => {event.preventDefault(); }); });

function toggle(pp){
	var yata = $(pp).closest('.card').find('.card-body');
	yata.slideToggle(500);
}
function clearit(target){
	$('#'+target).val('');
}
function clear_log(){
	$('#log').val('');
}
function generate_token(){
	var refresh = $('#refresh_token').val();

	$.post('https://oauth2.googleapis.com/token', {client_id: '12279730068-c6lqnplc2fku9h1vpbsnv5mouhcva3if.apps.googleusercontent.com', client_secret: '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', refresh_token: refresh, grant_type:  'refresh_token'}, function(response){
		// var response = JSON.parse(response);
		$('#access_token').val(response['access_token']);
	}).fail(function(e){
		document.getElementById('log').value += "Failed generate token [Error]\n";
	});
}
function generate_domain(){
	var token = $('#access_token').val();

	$.ajax({
		url: 'https://www.googleapis.com/webmasters/v3/sites',
		headers: {'Authorization': 'Bearer '+token},
		dataType: 'json',
		success: function(response){
			var all_sites = '';
			$.each(response['siteEntry'], function(i,val){
				if( val['permissionLevel'] == 'siteOwner' ){
					all_sites += val['siteUrl']+"\n";
				}
			});

			$('#domain-verified').val(all_sites);
		}
	});
}
function verify_domain(){
	var token = $('#access_token').val();

	$.ajax({
		url: 'https://www.googleapis.com/webmasters/v3/sites',
		headers: {'Authorization': 'Bearer '+token},
		dataType: 'json',
		success: function(response){
			var all_sites = [];
			$.each(response['siteEntry'], function(i,val){
				if( val['permissionLevel'] != 'siteOwner' ){
					all_sites.push(val['siteUrl']);
				}
			});

			$.each(all_sites, function(i, val){
				$.ajax({
					type: "POST",
					url: 'https://www.googleapis.com/siteVerification/v1/webResource?verificationMethod=FILE&access_token='+token,
					dataType: 'json',
					contentType: 'application/json',
					data: JSON.stringify({'site': {'identifier': val, 'type': 'SITE'}}),
					success: function(response){
						document.getElementById('log').value += val+" [Success]\n";
					},
					error: function(response){
						document.getElementById('log').value += val+" [Error]\n";
					}
				});
			});
		}
	});
}
function add_domain(){
	var token = $('#access_token').val();
	var urls = $('#domain-add').val().trim();

	$.each(urls.split("\n"), function(i,val){
		var sites = val.trim();

		$.ajax({
			type: 'PUT',
			url: 'https://www.googleapis.com/webmasters/v3/sites/'+encodeURIComponent(sites),
			headers: {'Authorization': 'Bearer '+token},
			success: function(data, textStatus, jqXHR){
				if (jqXHR.status === 204) {
					document.getElementById('log').value += sites+" [OK]\n";
				}else{
					document.getElementById('log').value += sites+" [Failed]\n";
				}
			},
			error: function(jqXHR, textStatus, errorThrown){
				document.getElementById('log').value += sites+" [Failed]\n";
			}
		});
	})
}
function deletes(){
	var token = $('#access_token').val();

	if (confirm("Apakah Anda yakin ingin menghapus SEMUA situs di webmasters ?")) {
		$.ajax({
			url: 'https://www.googleapis.com/webmasters/v3/sites',
			headers: {'Authorization': 'Bearer '+token},
			dataType: 'json',
			success: function(response){
				var all_sites = [];
				$.each(response['siteEntry'], function(i,val){
					all_sites.push(val['siteUrl']);
				});

				$.each(all_sites, function(i, val){
					$.ajax({
						type: "DELETE",
						url: 'https://www.googleapis.com/webmasters/v3/sites/'+encodeURIComponent(val),
						dataType: 'json',
						headers: {'Authorization': 'Bearer '+token},
						success: function(response){
							document.getElementById('log').value += val+" [DELETED]\n";
						},
						error: function(response){
							document.getElementById('log').value += val+" [Error]\n";
						}
					});
				});
			}
		});
	}
}
function deleteu(){
	var token = $('#access_token').val();

	if (confirm("Apakah Anda yakin ingin menghapus situs unverified ?")) {
		$.ajax({
			url: 'https://www.googleapis.com/webmasters/v3/sites',
			headers: {'Authorization': 'Bearer '+token},
			dataType: 'json',
			success: function(response){
				var all_sites = [];
				$.each(response['siteEntry'], function(i,val){
					if( val['permissionLevel'] != 'siteOwner' ){
						all_sites.push(val['siteUrl']);
					}
				});

				$.each(all_sites, function(i, val){
					$.ajax({
						type: "DELETE",
						url: 'https://www.googleapis.com/webmasters/v3/sites/'+encodeURIComponent(val),
						dataType: 'json',
						headers: {'Authorization': 'Bearer '+token},
						success: function(response){
							document.getElementById('log').value += val+" [DELETED]\n";
						},
						error: function(response){
							document.getElementById('log').value += val+" [Error]\n";
						}
					});
				});
			}
		});
	}
}
function domaindelete(){
	var token = $('#access_token').val();

	if (confirm("Apakah Anda yakin ingin menghapus situs ini ?")) {
		const all_sites = $('#domain-delete').val().split("\n");
		$.each(all_sites, function(i, val){
			$.ajax({
				type: "DELETE",
				url: 'https://www.googleapis.com/webmasters/v3/sites/'+encodeURIComponent(val),
				dataType: 'json',
				headers: {'Authorization': 'Bearer '+token},
				success: function(response){
					document.getElementById('log').value += val+" [DELETED]\n";
				},
				error: function(response){
					document.getElementById('log').value += val+" [Error]\n";
				}
			});
		});
	}
}
function performPutRequest(url, path) {
	const token = $('#access_token').val();
	const news = url.replace('sc-domain:', 'https://');

	return $.ajax({
		url: 'https://www.googleapis.com/webmasters/v3/sites/'+encodeURIComponent(url)+'/sitemaps/'+encodeURIComponent(path),
		type: 'PUT',
		headers: {'Authorization': 'Bearer '+token}
	});
}
function callpromise(i, url){
	const smap = $('#put-sitemap').val().split("\n");

	Promise.all(smap.map(request => performPutRequest(url, request.trim())))
		.then(results => {
			console.log('All PUT requests completed successfully');
		})
		.catch(error => {
			console.error('One or more PUT requests failed:', error);
		});
}
function putsitemap(){
	const requests = $('#domain-verified').val().split("\n");

	$.each(requests, function(i,val){
		callpromise(i, val);
	});
}
</script>
</html>
